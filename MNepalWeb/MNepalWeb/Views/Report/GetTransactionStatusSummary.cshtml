@{
    ViewBag.Title = "GetTransactionStatusSummary";
}
<link href="~/Content/plugins/jquery-ui/jquery-ui-1.12.1.custom/jquery-ui.css" rel="stylesheet" />

<!-- =============================================== -->
<!-- Content Header (Page header) -->
<section class="content-header">
    <h1>
        Report
        <small>TransactionStatusSummary</small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-user"></i>Report</a></li>
        <li class="active">TransactionStatusSummary</li>
    </ol>
</section>

<section class="content">
    <!-- Main row -->
    <div class="row">

        <!-- Start -->
        <div class="col-xs-12">

            <div class="box box-primary">
                <div class="box-header with-border">
                    <h3 class="box-title">TransactionStatusSummary</h3>
                </div>
                <!-- /.box-header -->
                <!--Search-->
                <div class="box-body">
                    <br />
                    <div class="row">
                        <div class="col-md-6">
                            <span style="color:red">@ViewBag.error</span>

                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group" id="form">
                            <div id="dateRange">
                                <div class="form-group">
                                    <div class="col-md-4 form-group">
                                        <label>From</label>
                                        @Html.TextBox("StartDate","", new { @id = "StartDate", @class = "form-control", @maxlength = "10", @placeholder = "DD/MM/YYYY",@required="required" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        </div>
                        <!-- /.box-body -->
                        <div class="box-footer">
                            <input type="submit" class="btn btn-primary" id="btnSearch" name="txtSearch" value="Search" />
                        </div>
                        <!-- /.box-footer -->
                        <!-- /.box-body -->
                    </div>
                    <div id="data" class="box box-primary">
                        <!--Report List-->
                        <div class="box-body" id="grid">
                            <table id="SearchResultTable" class="table table-striped table-bordered" style="display:none">
                                <thead>
                                    <tr>
                                        <th>Transaction Count</th>
                                        <th>Response Code</th>

                                    </tr>
                                </thead>
                                
                            </table>

                        </div>
                        <div class="overlay" id="loading" style="display:none;">
                            <i class="fa fa-refresh fa-spin"></i>
                        </div>



                    </div>
                    <!--Report List-->
                </div>
            </div>
            <!-- /.col-xs--->
            <!-- End-->
            <!-- /.row -->
</section>
@section scripts{
    <script src="~/Content/plugins/jquery-ui/jquery-ui-1.12.1.custom/jquery-ui.js"></script>
    <script type="text/javascript">

        $(document).ready(function () {
            var table;

            $('#btnSearch').click(function () {

                var StartDate = $('#StartDate').val();

                if ($.fn.DataTable.isDataTable('#SearchResultTable')) {
                    table.destroy();
                }
                $('#loading').show();
                $('#btnSearch').prop("disabled", true);
                table = $('#SearchResultTable').DataTable({
                    lengthChange: false,
                    searching: false,
                    "proccessing": true,
                    "serverSide": true,
                    "aaSorting": [],
                    orderCellsTop: false,
                    fixedHeader: true,
                    "ajax": {
                        data: function (d) {
                            d.Date = StartDate
                        },
                        url: "@Url.Action("GetTransactionStatusSummaryTable", "Report")",
                        type: 'POST'

                    },
                    "columns": [
                              { "data": "TransactionCount", sortable: false },
                              { "data": "ResponseCode", sortable: false }

                    ],
                    "drawCallback": function (settings) {
                        $('#SearchResultTable').show();
                        $('#loading').hide();
                        $('#btnSearch').prop("disabled", false);

                    }, 
                  //  "footerCallback": function (row, data, start, end, display) {
                    //    debugger;
                    //    var api = this.api(), data;

                    //    // Remove the formatting to get integer data for summation
                    //    var intVal = function (i) {
                    //        return typeof i === 'string' ?
                    //            i.replace(/[\$,]/g, '') * 1 :
                    //            typeof i === 'number' ?
                    //            i : 0;
                    //    };
                    //    //  this.api().context[0].json.Sum
                    //    // Total over all pages
                    //    total = api.context[0].json.Sum;

                    //    // Total over this page
                    //    pageTotal = api
                    //        .column(4, { page: 'current' })
                    //        .data()
                    //        .reduce(function (a, b) {
                    //            return intVal(a) + intVal(b);
                    //        }, 0);

                    //    // Update footer
                    //    $(api.column(4).footer()).html(
                    //      'Total: ' + pageTotal + ' /-'
                    //    );
                    //    $(api.column(6).footer()).html(
                    //    'Grand Total: ' + total + ' /-'
                    //  );
                    //}


                });

            });




            $("#StartDate").datepicker(
                {
                    dateFormat: 'dd/mm/yy',
                    maxDate: new Date,
                    //onSelect: function (dateText) {
                    //    changed = "T";
                    //    var from = $('#EndDate').val().split("/");
                    //    if (from != "") {
                    //        var EDate = new Date(from[2], from[1] - 1, from[0]);
                    //        var to = dateText.split("/");
                    //        var SDate = new Date(to[2], to[1] - 1, to[0]);;
                    //        if (SDate > EDate) {
                    //            $('#EndDate').val("");
                    //            $('#message').text('End Date cannot be less than Start Date');
                    //        }
                    //        else {
                    //            $('#message').text("");
                    //        }
                    //    }
                    //},
                    showAnim: "slideDown"
                });


            //$("#EndDate").datepicker(
            //    {
            //        dateFormat: 'dd/mm/yy',
            //         maxDate: new Date,
            //         onSelect: function (dateText) {
            //             changed = "T";
            //            var from = $('#StartDate').val().split("/");
            //            if (from != "") {
            //                var SDate = new Date(from[2], from[1] - 1, from[0]);
            //                var to = dateText.split("/");
            //                var EDate = new Date(to[2], to[1] - 1, to[0]);;
            //                if (EDate < SDate) {
            //                    debugger;
            //                    $('#EndDate').val("");
            //                    $('#message').text('End Date cannot be less than Start Date');
            //                }
            //                else {
            //                    $('#message').text("");
            //                }
            //            }
            //        },
            //        showAnim: "slideDown"



            //    });

        });






    </script>
}